<!DOCTYPE html>
    <html lang="ko">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>my project</title>
        <link rel="stylesheet" href="../assets/css/reset.css">
        <link rel="stylesheet" href="../assets/css/project.css">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css"/>
        <script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>
    </head>
    <body>
        <div class="project_popup">
            <section class="header">
                <div class="h_top">
                    <span><img src="../assets/image/icon/picture_icon.png" alt="갤러리 아이콘"></span>
                    <p>file //파일 명</p>
                    <div class="all_btn">
                        <button class="mini_btn"><span></span></button>
                        <button class="max_btn"><span></span></button>
                        <button class="close_btn"><span></span></button>
                    </div>
                </div>
                <div class="h_bot">
                    <ul>
                        <li>파일</li>
                        <li>EXIF</li>
                    </ul>
                    <span><img src="../assets/image/icon/pin_icon.png" alt="고정 아이콘"></span>
                </div>
            </section>

            <section class="main">
                <div class="swiper mySwiper">
                    <div class="swiper-wrapper">
                        <!-- <div class="swiper-slide">
                            <div class="info">
                                <dl class="name">
                                    <dt>프로젝트 이름:</dt>
                                    <dd>file //123</dd>
                                </dl>
                                <dl class="date">
                                    <dt>프로젝트 기간:</dt>
                                    <dd>date //123 ~ 123</dd>
                                </dl>
                                <dl class="comment">
                                    <dt>코멘트</dt>
                                    <dd>comment //어쩌구저쩌구</dd>
                                </dl>
                            </div>
                                
                            <ul>
                                <li><img src="../assets/image/folder/file/no.webp" alt=""></li>
                            </ul>
                        </div> -->
                      
                        <div class="footer">
                            <button class="zoom_out">축소</button>
                            <button class="zoom_in">확대</button>
                            <div class="swiper-button-prev"></div>
                            <div class="swiper-button-next"></div>
                            <div class="swiper-pagination"></div>
                        </div>
                    </div>
                </div>
            </section>
        </div>
    </body>
    <!-- <script>
        fetch('../assets/js/project.json')
            .then((response) =>{
                if(!response.ok){
                    throw new Error("400 아님 500 에러남");
                }
                return response.json()
            })  
            .then((결과) =>{
                console.log(결과)
                for (let i = 0; i < data.length; i++) {
                    const element = array[i];
                }
            })
            .catch(()=>{
                console.log('에러남')
            })
    </script> -->

    <!-- JSON 데이터를 HTML 내부에 포함 -->
    <script id="json-data" type="application/json">
        [
            {
                "file":"비상 수학 교과서",
                "image":[1,2,3,4,5,6,7,8,9],
                "comment":"특이사항 없음",
                "date":"23.01.01 ~ 23.01.01",
                "no":1
            },
            {
                "file":"미래엔 영어 교과서",        
                "image":[1,2,3,4,5,6],
                "comment":"특이사항 없음",
                "date":"23.01.01 ~ 23.01.01",
                "no":2
            },
            {
                "file":"비상 수학 교과서",
                "image":[1,2,3,4,5,6,7,8,9],
                "comment":"특이사항 없음",
                "date":"23.01.01 ~ 23.01.01",
                "no":1
            },
            {
                "file":"미래엔 영어 교과서",        
                "image":[1,2,3,4,5,6],
                "comment":"특이사항 없음",
                "date":"23.01.01 ~ 23.01.01",
                "no":2
            },
            {
                "file":"비상 수학 교과서",
                "image":[1,2,3,4,5,6,7,8,9],
                "comment":"특이사항 없음",
                "date":"23.01.01 ~ 23.01.01",
                "no":1
            },
            {
                "file":"미래엔 영어 교과서",        
                "image":[1,2,3,4,5,6],
                "comment":"특이사항 없음",
                "date":"23.01.01 ~ 23.01.01",
                "no":2
            }
        ]
    </script>

    <script>
        // JSON 데이터 가져오기
        const jsonData = document.getElementById('json-data').textContent;
        const parsedData = JSON.parse(jsonData);    
        let footer = document.querySelector(".footer");

        parsedData.map(function(data,arr){
            // info
            let info = document.createElement('div');
            info.setAttribute('class', 'info');
            
            let name = document.createElement('dl');
            let dt1 = document.createElement('dt');
            let dd1= document.createElement('dd');
            name.appendChild(dt1).innerText = "프로젝트 이름: ";
            name.appendChild(dd1).innerText = parsedData[arr].file;

            let date = document.createElement('dl');
            let dt2 = document.createElement('dt');
            let dd2= document.createElement('dd');
            date.appendChild(dt2).innerText = "프로젝트 기간: ";
            date.appendChild(dd2).innerText = parsedData[arr].date;

            let comment = document.createElement('dl');
            let dt3 = document.createElement('dt');
            let dd3= document.createElement('dd');
            comment.appendChild(dt3).innerText = "코멘트: ";
            comment.appendChild(dd3).innerText = parsedData[arr].comment;

            info.append(name);
            info.append(date);
            info.append(comment);

            //image
            let ul = document.createElement('ul');
            
            for (let i = 0; i < parsedData[arr].image.length; i++) {
                let li = document.createElement('li');
                let img = document.createElement('img');
                img.src = `../assets/image/folder/`+ parsedData[arr].file + `/`+ (i + 1)+`.webp`;

                ul.append(li);
                li.append(img);
            }

            // 전체 slide
            let slide = document.createElement('div');
            slide.setAttribute("class", "swiper-slide");
            slide.append(info);
            slide.append(ul);

            let wrapper = document.querySelector('.main .swiper-wrapper');
            wrapper.append(slide);
       
        });

        let currentIdx = 0;
        //swiper slide
        var swiper = new Swiper(".mySwiper", {
            speed:0,
            effect: "fade",
            navigation: {
                nextEl: ".swiper-button-next",
                prevEl: ".swiper-button-prev",
            },
            pagination: {
                el: ".swiper-pagination",
                clickable: true,
            },
            on:{
                slideChange : function(x){
                    currentIdx = swiper.activeIndex;
                    console.log("넘어감");
                    console.log(swiper.previousIndex);
                    zoomFn();     
                }
            }
        });


        
        // 이미지 확대 
        let zoom = 100;
        let zoomInBtn = document.querySelector(".footer .zoom_in");
        let zoomOutBtn = document.querySelector(".footer .zoom_out");
        let slide = document.querySelectorAll('.main .swiper-slide');
        let zoomTg = slide[currentIdx].querySelector('.main ul');
        let zoomFn;
        parsedData.forEach((number, index) => {
            zoomIn = () =>{
                zoom = zoom + 20;
                if(zoom >= 300) zoom = 300;
                zoomTg.style.transform = `scale(`+ zoom + `%)`;
            }
    
            zoomOut = () =>{
                zoom = zoom - 10;
                if(zoom <= -200) zoom = -200; 
                zoomTg.style.transform = `scale(`+ zoom + `%)`;
            }

            zoomFn = () =>{
                if(currentIdx == footer.dataset.num){
                    zoomInBtn.onclick = () => zoomIn();
                    zoomOutBtn.onclick = () => zoomOut();
                }else{
                    zoom = 100;
                }
            }
            zoomFn();
        });
    </script>
</html>